<!DOCTYPE html>
<html>
	<head>
		<style>
			*{
				margin: 0;
                padding: 0;
                text-align: center;
			}
		</style>
	</head>
	<body>
		<script type="x-shader/x-vertex" id="vshader">
			attribute vec3 aPosition;
			void main() {
				gl_Position = vec4(aPosition, 1.0);
				gl_PointSize = 20.0;
			}
		</script>
		<script type="x-shader/x-fragment" id="fshader">
			precision mediump float;
			uniform vec4 uColor;
			void main() {
				gl_FragColor = uColor;
			}
		</script>
		<canvas id="c" width="400" height="400"></canvas>
        <audio src="cat3.wav" id="spkr"></audio>
		<script type="text/javascript" src="initUtils.js"></script>
		<script>
			(function (root) {
				var canvas = document.getElementById("c"),
					gl = initializeWebGL(canvas),
					program = initializeProgram(gl, initializeShader(gl, "vshader"), initializeShader(gl, "fshader")),
					aPosition = gl.getAttribLocation(program,"aPosition"),
					uColor = gl.getUniformLocation(program,"uColor"),
					cvrt = function (i, y) {
						var a = canvas.width / 2;
						return ((i - a) / a) * (y ? -1 : 1);
					};

				gl.useProgram(program);

                /**
                    DRAW AN ELLIPSE
                    @param	h,k	int	center
                    @param	rad	float	default radius
                    @param	a, b	float	radius of x and y for ellipse
                    @param	R,G,B	float	color
                    @param	deg	float	complete degrees
                    @param	theta	float	rotate angle ccw (radians)
                    @return	undefined
                */
                root.drawEllipse = function (h, k, rad, a, b, R, G, B, deg, theta) {
                    var i,
                        x,
                        y,
                        radian,
                        vertexBuffer,
                        vertices = [cvrt(h), cvrt(k, 1), 0];

                    gl.uniform4f(uColor, R / 255, G / 255, B / 255, 1);

                    for (i = 0; i <= deg; i += 1) {
                        radian = i / 180 * Math.PI;
                        x = (a * (rad / canvas.width)) * Math.cos(radian);
                        y = (b * (rad / canvas.width)) * Math.sin(radian);

                        vertices.push.apply(vertices, [cvrt(h) + (x * Math.cos(theta) - y * Math.sin(theta)), cvrt(k, 1) + (x * Math.sin(theta) + y * Math.cos(theta)), 0]);

                        vertexBuffer = gl.createBuffer();

                        gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);
                        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.STATIC_DRAW);
                        gl.vertexAttribPointer(aPosition, 3, gl.FLOAT, false, 0, 0);
                        gl.enableVertexAttribArray(aPosition);

                        gl.drawArrays(gl.TRIANGLE_FAN, 0, vertices.length / 3);
                    }
                },

                /**
                    DRAW A TRIANGLE
                    @param	R,G,B		float		color
                    @param	vertices	float		vertices
                    @param	t		    gl.TYPE
                    @return	undefined
                */
                root.drawPolygon = function (r, g, b, vertices, t) {
                    var i,
                        n,
                        vertexBuffer;
                    
                    n = vertices.length / 3;
                    
                    gl.uniform4f(uColor, r / 255, g / 255, b / 255, 1);
                    
                    for (i = 0; i < n; i += 1) {
                        vertices[i * 3] = cvrt(vertices[i * 3]);
                        vertices[(i * 3) + 1] = cvrt(vertices[(i * 3) + 1], 1);
                    }
                    
                    for (i = 0; i < n; i += 1) {
                        vertexBuffer = gl.createBuffer();
                        gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);
                        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.STATIC_DRAW);
                        gl.vertexAttribPointer(aPosition, 3, gl.FLOAT, false, 0, 0);
                        gl.enableVertexAttribArray(aPosition);
                        gl.drawArrays(t || gl.TRIANGLE_FAN, 0, n);
                    }
                };

                // right ear
                drawPolygon(69,69,69,[253,166,0,258,156,0,262,146,0,264,134,0,266,125,0,267,117,0,266,107,0,264,96,0,262,89,0,257,85,0,252,82,0,246,81,0,238,81,0,227,83,0,213,85,0,199,88,0,187,91,0,177,93,0,170,96,0,202,131,0]); 
                drawPolygon(41,39,35,[253,166,0,258,156,0,262,146,0,264,134,0,266,125,0,267,117,0,266,107,0,264,96,0,262,89,0,257,85,0,252,82,0,246,81,0,238,81,0,227,83,0,213,85,0,199,88,0,187,91,0,177,93,0,170,96,0,202,131,0], gl.LINE_STRIP); 
                drawPolygon(213,190,193,[253,163,0,255,156,0,257,143,0,258,134,0,258,128,0,258,123,0,256,116,0,256,110,0,253,103,0,251,98,0,248,97,0,242,96,0,236,96,0,226,97,0,219,98,0,209,101,0,205,102,0,211,106,0,216,111,0,222,117,0,229,124,0,233,129,0,238,136,0,242,141,0,244,145,0,246,149,0,248,154,0,250,157,0]); 
                drawPolygon(41,39,35,[253,163,0,255,156,0,257,143,0,258,134,0,258,128,0,258,123,0,256,116,0,256,110,0,253,103,0,251,98,0,248,97,0,242,96,0,236,96,0,226,97,0,219,98,0,209,101,0,205,102,0,211,106,0,216,111,0,222,117,0,229,124,0,233,129,0,238,136,0,242,141,0,244,145,0,246,149,0,248,154,0,250,157,0], gl.LINE_STRIP); 
                
                // left ear
                drawPolygon(69,69,69,[112,227,0,85,215,0,67,205,0,50,197,0,41,190,0,36,182,0,36,174,0,38,168,0,45,161,0,57,153,0,74,142,0,85,135,0,109,126,0]); 
                drawPolygon(41,39,35,[112,227,0,85,215,0,67,205,0,50,197,0,41,190,0,36,182,0,36,174,0,38,168,0,45,161,0,57,153,0,74,142,0,85,135,0,109,126,0], gl.LINE_STRIP); 
                drawPolygon(213,190,193,[92,152,0,63,167,0,57,171,0,56,173,0,55,175,0,53,177,0,53,180,0,53,184,0,56,190,0,63,197,0,73,204,0,80,210,0,90,215,0,100,220,0,112,226,0,101,202,0,96,185,0,92,171,0,92,160,0,92,156,0]);
                drawPolygon(41,39,35,[92,152,0,63,167,0,57,171,0,56,173,0,55,175,0,53,177,0,53,180,0,53,184,0,56,190,0,63,197,0,73,204,0,80,210,0,90,215,0,100,220,0,112,226,0,101,202,0,96,185,0,92,171,0,92,160,0,92,156,0], gl.LINE_STRIP);
                
                // head
                drawPolygon(255,244,214,[160,250,0,153,250,0,147,250,0,141,250,0,137,250,0,134,249,0,129,245,0,123,239,0,118,232,0,109,221,0,104,211,0,99,197,0,94,183,0,93,173,0,92,162,0,92,154,0,92,144,0,95,135,0,98,128,0,102,121,0,109,116,0,116,111,0,127,104,0,141,99,0,148,97,0,157,95,0,166,94,0,174,94,0,182,95,0,192,97,0,203,102,0,209,105,0,216,111,0,223,118,0,230,126,0,236,132,0,242,141,0,246,149,0,249,156,0,252,163,0,253,173,0,253,182,0,253,187,0,250,194,0,249,199,0,245,205,0,241,211,0,237,216,0,234,220,0,232,223,0,231,224,0,225,228,0,215,234,0,178,248,0]);
                drawPolygon(41,39,35,[160,250,0,153,250,0,147,250,0,141,250,0,137,250,0,134,249,0,129,245,0,123,239,0,118,232,0,109,221,0,104,211,0,99,197,0,94,183,0,93,173,0,92,162,0,92,154,0,92,144,0,95,135,0,98,128,0,102,121,0,109,116,0,116,111,0,127,104,0,141,99,0,148,97,0,157,95,0,166,94,0,174,94,0,182,95,0,192,97,0,203,102,0,209,105,0,216,111,0,223,118,0,230,126,0,236,132,0,242,141,0,246,149,0,249,156,0,252,163,0,253,173,0,253,182,0,253,187,0,250,194,0,249,199,0,245,205,0,241,211,0,237,216,0,234,220,0,232,223,0,231,224,0,225,228,0,215,234,0,178,248,0], gl.LINE_STRIP);
                
                // tail
                drawPolygon(255,244,214,[302,189,0,303,185,0,307,183,0,313,182,0,318,184,0,321,185,0,325,189,0,327,194,0,328,200,0,328,206,0,325,213,0,324,218,0,321,220,0,319,223,0,314,225,0,307,226,0,301,224,0,295,222,0,289,219,0,284,216,0,280,210,0,278,205,0,277,201,0,276,193,0,277,188,0,280,180,0,281,174,0,285,168,0,288,166,0,291,163,0,296,162,0,298,162,0,302,161,0,309,161,0,315,163,0,322,164,0,326,166,0,330,190,0]); 
                drawPolygon(41,39,35,[302,189,0,303,185,0,307,183,0,313,182,0,318,184,0,321,185,0,325,189,0,327,194,0,328,200,0,328,206,0,325,213,0,324,218,0,321,220,0,319,223,0,314,225,0,307,226,0,301,224,0,295,222,0,289,219,0,284,216,0,280,210,0,278,205,0,277,201,0,276,193,0,277,188,0,280,180,0,281,174,0,285,168,0,288,166,0,291,163,0,296,162,0,298,162,0,302,161,0,309,161,0,315,163,0,322,164,0,326,166,0,330,170,0], gl.LINE_STRIP); 
                drawPolygon(255,244,214,[323,284,0,316,288,0,309,295,0,303,300,0,297,302,0,290,308,0,284,311,0,284,295,0,291,294,0,297,292,0,304,287,0,309,282,0,315,276,0,319,271,0,322,264,0,324,258,0,326,247,0,327,236,0,327,218,0,329,170,0,334,177,0,338,187,0,339,196,0,339,205,0,338,216,0,338,225,0,337,237,0,335,251,0,334,257,0,330,268,0]); 
                drawPolygon(41,39,35,[329,170,0,334,177,0,338,187,0,339,196,0,339,205,0,338,216,0,338,225,0,337,237,0,335,251,0,334,257,0,330,268,0,323,284,0, 323,284,0,316,288,0,309,295,0,303,300,0,297,302,0,290,308,0,284,311,0,284,295,0,291,294,0,297,292,0,304,287,0,309,282,0,315,276,0,319,271,0,322,264,0,324,258,0,326,247,0,327,236,0,327,218,0], gl.LINE_STRIP); 
                
                // body
                drawPolygon(255,244,214,[229,224,0,240,234,0,250,247,0,266,267,0,280,291,0,285,298,0,289,311,0,289,320,0,287,331,0,283,336,0,276,339,0,266,343,0,254,346,0,240,348,0,237,351,0,232,355,0,225,359,0,221,359,0,217,359,0,214,358,0,212,356,0,207,354,0,199,349,0,187,350,0,182,348,0,174,345,0,169,339,0,163,325,0,159,313,0,158,303,0,157,285,0,158,268,0,160,250,0]); 
                drawPolygon(41,39,35,[229,224,0,240,234,0,250,247,0,266,267,0,280,291,0,285,298,0,289,311,0,289,320,0,287,331,0,283,336,0,276,339,0,266,343,0,254,346,0,240,348,0,237,351,0,232,355,0,225,359,0,221,359,0,217,359,0,214,358,0,212,356,0,207,354,0,199,349,0,187,350,0,182,348,0,174,345,0,169,339,0,163,325,0,159,313,0,158,303,0,157,285,0,158,268,0,160,250,0], gl.LINE_STRIP); 
                
                // outline
                drawPolygon(41,39,35,[166,292,0,172,304,0,178,315,0,184,325,0,189,335,0,197,345,0,201,350,0,204,353,0,208,355,0,212,356,0,214,359,0,216,359,0,222,360,0,227,359,0,231,356,0,234,354,0,236,352,0,241,346,0,244,340,0,247,333,0,248,327,0,249,321,0,250,311,0,252,303,0,251,295,0,252,288,0], gl.LINE_STRIP); 
                drawPolygon(41,39,35,[206,291,0,207,295,0,208,298,0,209,307,0,209,311,0,210,314,0,210,320,0,212,325,0,212,329,0,213,333,0,213,337,0,213,340,0,213,344,0,212,348,0,212,351,0,212,353,0,212,355,0], gl.LINE_STRIP); 
                
                // forehead
                drawPolygon(255,175,189,[149,120,0,142,122,0,139,124,0,135,127,0,134,130,0,134,133,0,133,134,0,134,137,0,134,139,0,135,142,0,136,145,0,137,147,0,140,151,0,143,152,0,148,153,0,151,153,0,155,153,0,158,152,0,159,151,0,163,149,0,165,145,0,167,142,0,168,138,0,167,133,0,166,130,0,165,127,0,163,125,0]); 
                drawPolygon(41,39,35,[149,120,0,142,122,0,139,124,0,135,127,0,134,130,0,134,133,0,133,134,0,134,137,0,134,139,0,135,142,0,136,145,0,137,147,0,140,151,0,143,152,0,148,153,0,151,153,0,155,153,0,158,152,0,159,151,0,163,149,0,165,145,0,167,142,0,168,138,0,167,133,0,166,130,0,165,127,0,163,125,0,149,120,0], gl.LINE_STRIP); 
                
                // whiskers
                drawPolygon(255,244,214,[115,225,0,79,270,0,119,230,0]); 
                drawPolygon(255,244,214,[122,234,0,97,285,0,128,239,0]); 
                drawPolygon(255,244,214,[134,245,0,135,303,0,140,248,0]);
                drawPolygon(255,244,214,[242,173,0,294,163,0,243,179,0]); 
                drawPolygon(255,244,214,[244,184,0,296,188,0,244,189,0]); 
                drawPolygon(255,244,214,[242,194,0,290,214,0,241,200,0]); 
                drawPolygon(41,39,35,[115,225,0,79,270,0,119,230,0], gl.LINE_STRIP); 
                drawPolygon(41,39,35,[122,234,0,97,285,0,128,239,0], gl.LINE_STRIP); 
                drawPolygon(41,39,35,[134,245,0,135,303,0,140,248,0], gl.LINE_STRIP);
                drawPolygon(41,39,35,[242,173,0,294,163,0,243,179,0], gl.LINE_STRIP); 
                drawPolygon(41,39,35,[244,184,0,296,188,0,244,189,0], gl.LINE_STRIP); 
                drawPolygon(41,39,35,[242,194,0,290,214,0,241,200,0], gl.LINE_STRIP); 
                
                // left eye
                drawPolygon(41,39,35,[133,204,0,136,203,0,137,202,0,141,202,0,143,202,0,146,203,0,149,204,0,152,206,0,155,207,0,156,209,0,151,207,0,149,206,0,145,205,0,142,204,0,139,205,0,137,205,0,134,207,0,133,208,0,131,209,0,130,211,0,130,213,0,129,214,0,129,217,0,129,218,0,129,221,0,128,219,0,127,216,0,127,213,0,128,209,0,131,207,0]); 
                
                // nose
                drawPolygon(41,39,35,[185,204,0,187,203,0,189,201,0,190,201,0,191,201,0,192,202,0,191,203,0,189,205,0,188,205,0,186,205,0]); 
                
                // right eye
                drawEllipse(211, 168, 35, .6, 1, 41, 39, 35, 360, .9);
                drawEllipse(209, 159, 7, 1, 1, 255, 255, 255, 360, 1);
                drawPolygon(238,131,135,[221,177,0,222,176,0,222,173,0,221,171,0,220,169,0,219,167,0,218,165,0,217,163,0,214,162,0,215,163,0,216,165,0,216,167,0,216,169,0,214,169,0,214,170,0,213,170,0,211,170,0,209,169,0,206,167,0,204,167,0,202,166,0,204,170,0,206,172,0,208,174,0,210,177,0,213,177,0,216,178,0]); 
                
                
                canvas.onclick = function(){
                    var a = document.getElementById('spkr');
                    a.paused ? a.play() : a.pause();
                };
			}(this));
		</script>
	</body>
</html>
